@{
    ViewData["Title"] = "Listado de reservas";
}

<h2>Listado de reservas</h2>

<form method="get">
    <input type="date" name="Fecha" />
    <select name="Tipo">
        <option value="">Todos los tipos</option>
        <option value="Reserva">Normal</option>
        <option value="ReservaVIP">VIP</option>
        <option value="ReservaCumpleañero">Cumpleañero</option>
    </select>

    <select name="Estado">
        <option value="">Todos los estados</option>
        <option value="Pendiente">Pendiente</option>
        <option value="Confirmada">Confirmada</option>
        <option value="Cancelada">Cancelada</option>
        <option value="No asistió">No asistió</option>
    </select>

    <input type="text" name="Nombre" placeholder="Nombre" />
    <input type="text" name="Email" placeholder="Email" />

    <button type="submit">Buscar</button>
</form>


<div class="table-responsive mt-3">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>Nombre</th>
                <th>Tipo</th>
                <th>Fecha/Hora</th>
                <th>Personas</th>
                <th>Estado</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var r in Model)
            {
                <tr>
                    <td>@r.Nombre</td>

                    <td>
                        <span class="badge 
                            @(r.Discriminator switch {
                                "ReservaCumpleañero" => "bg-info text-dark",
                                "ReservaVIP" => "bg-warning text-dark",
                                _ => "bg-secondary"
                            })">
                            @(r.Discriminator switch
                            {
                                "ReservaCumpleañero" => "Cumpleañero",
                                "ReservaVIP" => "VIP",
                                _ => "Normal"
                            })
                        </span>
                    </td>

                    <td>@r.FechaHoraInicio.ToString("dd/MM HH:mm")</td>

                    <td>
                        <span class="badge bg-primary">
                            @r.CantidadPersonas
                        </span>
                    </td>

                    <td>
                        <span class="badge 
                            @(r.Estado switch {
                                "Confirmada" => "bg-success",
                                "Pendiente" => "bg-warning text-dark",
                                "Cancelada" => "bg-danger",
                                _ => "bg-secondary"
                            })">
                            @r.Estado
                        </span>
                    </td>
                    <td class="">
                        <a href="/Reservas/Detalle/@r.Id" class="btn btn-sm btn-outline-primary">
                            Ver detalle
                        </a>
                    </td>


                </tr>
            }
        </tbody>
    </table>
</div>


@{
    int pagina = ViewBag.Filtro.Pagina;
    int total = ViewBag.Total;
    int tamaño = ViewBag.Filtro.TamañoPagina;
    int totalPaginas = (int)Math.Ceiling((double)total / tamaño);
}

<nav aria-label="Paginación de reservas">
    <ul class="pagination justify-content-center">

        <!-- Anterior -->
        <li class="page-item @(pagina == 1 ? "disabled" : "")">
            <a class="page-link" href="?Pagina=@(pagina - 1)">Anterior</a>
        </li>

        <!-- Página actual -->
        <li class="page-item disabled">
            <span class="page-link">
                Página @pagina de @totalPaginas
            </span>
        </li>

        <!-- Siguiente -->
        <li class="page-item @(pagina == totalPaginas ? "disabled" : "")">
            <a class="page-link" href="?Pagina=@(pagina + 1)">Siguiente</a>
        </li>

    </ul>
</nav>

